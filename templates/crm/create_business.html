{{ define "content.html" }}
<!-- Business Form -->
<div class="mx-auto flex w-3/4 max-w-xl flex-col overflow-hidden rounded-lg bg-white shadow-sm dark:bg-gray-800 dark:text-gray-100">
  <form id="business-form" class="space-y-6 p-2 md:p-2">
    <input type="hidden" id="csrf_token" name="csrf_token" value="{{ .CSRFToken }}" />
    <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
      <div class="space-y-1">
        <label for="name" class="font-medium">Business Name*</label>
        <input
          type="text"
          id="name"
          name="name"
          required
          class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
      </div>
      <div class="space-y-1">
        <label for="website" class="font-medium">Website</label>
        <input
          type="text"
          id="website"
          name="website"
          class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
      </div>
    </div>
    <div class="space-y-1">
      <label for="industry" class="font-medium">Industry</label>
      <input
        type="text"
        id="industry"
        name="industry"
        class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
    </div>
    <div class="space-y-1">
      <label class="group relative inline-flex items-center gap-3">
        <input
          type="checkbox"
          class="peer sr-only"
          id="is_active"
          name="is_active"
          checked />
        <span
          class="relative h-7 w-12 flex-none rounded-full bg-gray-300 transition-all duration-150 ease-out before:absolute before:left-1 before:top-1 before:size-5 before:rounded-full before:bg-white before:transition-transform before:duration-150 before:ease-out before:content-[''] peer-checked:bg-primary-500 peer-checked:before:translate-x-full peer-focus:ring peer-focus:ring-primary-500/50 peer-focus:ring-offset-2 peer-focus:ring-offset-white peer-disabled:cursor-not-allowed peer-disabled:opacity-75 dark:bg-gray-700 dark:peer-checked:bg-primary-500 dark:peer-focus:ring-offset-gray-900"></span>
        <span class="font-medium">Is Active</span>
      </label>
    </div>
    <div class="space-y-1">
      <label for="tax_id" class="font-medium">Tax ID</label>
      <input
        type="text"
        id="tax_id"
        name="tax_id"
        class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
    </div>
    <div class="space-y-1">
      <label for="google_business_profile" class="font-medium">Google Business Profile</label>
      <input
        type="text"
        id="google_business_profile"
        name="google_business_profile"
        class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
    </div>
    <button
      type="submit"
      class="inline-flex w-full items-center justify-center gap-2 rounded-lg border border-primary-700 bg-primary-700 px-8 py-4 font-semibold leading-6 text-white hover:border-primary-600 hover:bg-primary-600 hover:text-white focus:ring focus:ring-primary-400/50 active:border-primary-700 active:bg-primary-700 dark:focus:ring-primary-400/90">
      <svg
        class="hi-mini hi-paper-airplane inline-block size-5 opacity-50"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 20 20"
        fill="currentColor"
        aria-hidden="true">
        <path
          d="M3.105 2.289a.75.75 0 00-.826.95l1.414 4.925A1.5 1.5 0 005.135 9.25h6.115a.75.75 0 010 1.5H5.135a1.5 1.5 0 00-1.442 1.086l-1.414 4.926a.75.75 0 00.826.95 28.896 28.896 0 0015.293-7.154.75.75 0 000-1.115A28.897 28.897 0 003.105 2.289z" />
      </svg>
      <span>Submit</span>
    </button>
  </form>
</div>
<!-- END Business Form -->

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("create-business-form");
    const alertModal = document.getElementById("alertModal");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const data = new FormData(e.target);

      fetch("/crm/business", {
        method: "POST",
        credentials: "include",
        body: data,
      })
        .then((response) => {
          if (response.ok) {
            const token = response.headers.get("X-Csrf-Token");

            if (token) {
              const csrf_token = document.getElementById("csrf_token");

              if (!csrf_token) return;

              csrf_token.value = token;
            }

            return response.text();
          } else {
            return response.text().then((err) => {
              throw new Error(err);
            });
          }
        })
        .then((html) => {
          alertModal.outerHTML = html;
          handleCloseAlertModal();

          form.reset();
        })
        .catch(console.error);
    });
  });
</script>
{{ end }}
