<!-- Location Form -->
<div
	class="mx-auto flex w-3/4 max-w-xl flex-col overflow-hidden rounded-lg bg-white shadow-sm dark:bg-gray-800 dark:text-gray-100">
	<form id="createLocationForm" class="space-y-6 p-2 md:p-2">
		<input type="hidden" id="csrf_token" name="csrf_token" value="{{ .CSRFToken }}" />
		<div class="space-y-1">
			<label for="location_type_id" class="font-medium">Location Type*</label>
			<select id="location_type_id" name="location_type_id" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary">
				{{ range .VendingLocations }}
				<option value="{{ .VendingLocationID }}">{{ .LocationType }}</option>
				{{ end }}
			</select>
		</div>
		<div class="space-y-1">
			<label for="business_id" class="font-medium">Business*</label>
			<select id="business_id" name="business_id" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary">
				{{ range .Businesses }}
				<option value="{{ .BusinessID }}">{{ .Name }}</option>
				{{ end }}
			</select>
		</div>
		<div class="space-y-1">
			<label for="business_contact_id" class="font-medium">Business Contact*</label>
			<select id="business_contact_id" name="business_contact_id" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary">
				{{ range .BusinessContacts }}
				<option value="{{ .BusinessContactID }}">{{ .FirstName }} {{ .LastName }}</option>
				{{ end }}
			</select>
		</div>
		<div class="space-y-1">
			<label for="name" class="font-medium">Location Name*</label>
			<input type="text" id="name" name="name" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="longitude" class="font-medium">Longitude</label>
			<input type="text" id="longitude" name="longitude"
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="latitude" class="font-medium">Latitude</label>
			<input type="text" id="latitude" name="latitude"
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="street_address_line_one" class="font-medium">Street Address Line One*</label>
			<input type="text" id="street_address_line_one" name="street_address_line_one" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="street_address_line_two" class="font-medium">Street Address Line Two</label>
			<input type="text" id="street_address_line_two" name="street_address_line_two"
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="city_id" class="font-medium">City*</label>
			<select id="city_id" name="city_id" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary">
				{{ range .Cities }}
				<option value="{{ .CityID }}">{{ .City }}</option>
				{{ end }}
			</select>
		</div>
		<div class="space-y-1">
			<label for="zip_code" class="font-medium">Zip Code*</label>
			<input type="text" id="zip_code" name="zip_code" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="state" class="font-medium">State*</label>
			<input type="text" id="state" name="state" required
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="opening" class="font-medium">Opening Time</label>
			<input type="text" id="opening" name="opening"
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>
		<div class="space-y-1">
			<label for="closing" class="font-medium">Closing Time</label>
			<input type="text" id="closing" name="closing"
				class="block w-full rounded-lg border border-gray-200 px-5 py-3 leading-6 placeholder-gray-500 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:placeholder-gray-400 dark:focus:border-primary" />
		</div>

		<!-- Submit Button -->
		<button type="submit"
			class="inline-flex w-full items-center justify-center gap-2 rounded-lg border border-primary-700 bg-primary-700 px-8 py-4 font-semibold leading-6 text-white hover:border-primary-600 hover:bg-primary-600 hover:text-white focus:ring focus:ring-primary-400/50 active:border-primary-700 active:bg-primary-700 dark:focus:ring-primary-400/90">
			<svg class="hi-mini hi-paper-airplane inline-block size-5 opacity-50" xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
				<path
					d="M3.105 2.289a.75.75 0 00-.826.95l1.414 4.925A1.5 1.5 0 005.135 9.25h6.115a.75.75 0 010 1.5H5.135a1.5 1.5 0 00-1.442 1.086l-1.414 4.926a.75.75 0 00.826.95 28.896 28.896 0 0015.293-7.154.75.75 0 000-1.115A28.897 28.897 0 003.105 2.289z" />
			</svg>
			<span>Submit</span>
		</button>
	</form>
</div>
<!-- END Location Form -->

<script>
	document.addEventListener("DOMContentLoaded", () => {
		const form = document.getElementById("createLocationForm");
		const alertModal = document.getElementById("alertModal");

		form.addEventListener("submit", (e) => {
			e.preventDefault();
			const data = new FormData(e.target);

			fetch("/crm/location", {
				method: "POST",
				credentials: "include",
				body: data,
			})
				.then((response) => {
					if (response.ok) {
						const token = response.headers.get("X-Csrf-Token");

						if (token) {
							const csrf_token = document.getElementById("csrf_token");

							if (!csrf_token) return;

							csrf_token.value = token;
						}

						return response.text();
					} else {
						return response.text().then((err) => {
							throw new Error(err);
						});
					}
				})
				.then((html) => {
					alertModal.outerHTML = html;
					handleCloseAlertModal();

					form.reset();
				})
				.catch(console.error);
		});
	});
</script>